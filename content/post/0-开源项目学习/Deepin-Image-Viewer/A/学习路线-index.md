---
title: "Deepin Image Viewer"
description: "Deepin系统内置的看图软件"
date: 2024-12-27
image: 
math: 
license: 
hidden: false
comments: true
draft: true
categories: 
    - 开源项目学习
---

- [1. 项目概述](#1-项目概述)
- [2. 架构设计](#2-架构设计)
  - [2.1. 整体架构](#21-整体架构)
  - [2.2. 核心组件](#22-核心组件)
  - [2.2.1. 应用程序入口](#221-应用程序入口)
  - [2.2.2. 主窗口管理](#222-主窗口管理)
  - [2.2.3. 数据控制层](#223-数据控制层)
- [3. 技术栈](#3-技术栈)
  - [3.1. 核心框架技术](#31-核心框架技术)
  - [3.1.1. Qt6/QML框架](#311-qt6qml框架)
  - [3.1.2. DTK (Deepin Toolkit)](#312-dtk-deepin-toolkit)
  - [3.2. 构建系统](#32-构建系统)
  - [3.2.1. CMake构建系统](#321-cmake构建系统)
  - [3.3. 图像处理技术](#33-图像处理技术)
  - [3.3.1. 插件系统](#331-插件系统)
  - [3.3.2. 支持的图像格式](#332-支持的图像格式)
  - [3.4. 高级功能技术](#34-高级功能技术)
  - [3.4.1. OCR文本识别](#341-ocr文本识别)
  - [3.4.2. 打印功能](#342-打印功能)
  - [3.4.3. DBus集成](#343-dbus集成)
  - [3.5. 工具链和开发支持](#35-工具链和开发支持)
  - [3.5.1. 多语言支持](#351-多语言支持)
  - [3.5.2. 包管理](#352-包管理)
  - [3.5.3. 命令行支持](#353-命令行支持)
  - [3.6. 资源管理](#36-资源管理)
  - [3.6.1. 资源文件系统](#361-资源文件系统)
- [4. 项目特色](#4-项目特色)
- [5. Notes](#5-notes)


# 1. 项目概述

Deepin Image Viewer 是深度操作系统的官方图像查看器，采用现代化的Qt6/QML架构设计，提供了完整的图像查看、编辑和管理功能。

# 2. 架构设计

## 2.1. 整体架构

该项目采用分层架构设计，主要分为以下层次：

1. **用户界面层 (UI Layer)** - 基于QML实现
2. **业务逻辑层 (Business Logic Layer)** - C++后端组件
3. **数据访问层 (Data Access Layer)** - 文件系统和图像处理
4. **插件系统 (Plugin System)** - 扩展图像格式支持

## 2.2. 核心组件

## 2.2.1. 应用程序入口
应用程序的入口点位于 `main.cpp` ，负责初始化Qt应用程序、注册C++类型到QML环境、设置图像提供者和DBus服务。

## 2.2.2. 主窗口管理
- **主窗口**: `main.qml`   定义了应用程序的根窗口
- **堆栈管理**: `MainStack.qml`  管理不同视图之间的切换
- **图像查看器**: `ImageViewer.qml`  是核心的图像显示和操作组件

## 2.2.3. 数据控制层
- **全局控制器**: `globalcontrol.cpp`  提供全局的图像显示和导航控制
- **文件控制器**: `filecontrol.cpp`  处理文件操作和系统集成

# 3. 技术栈

## 3.1. 核心框架技术

## 3.1.1. Qt6/QML框架
项目基于Qt6框架构建，使用QML作为用户界面描述语言 。主要QML组件包括：
- 图像显示组件
- 缩略图列表视图 
- 导航控件  
- 对话框组件 

## 3.1.2. DTK (Deepin Toolkit)
项目深度集成了DTK组件库 ，提供了：
- 深度风格的UI组件
- 图标系统
- 样式主题支持
- 窗口管理功能

## 3.2. 构建系统

## 3.2.1. CMake构建系统
项目使用CMake作为构建系统，具有以下特点：
- 支持多架构构建（x86_64、arm64、loong64）
- QML编译集成
- 资源文件打包
- 条件编译支持Qt5/Qt6

## 3.3. 图像处理技术

## 3.3.1. 插件系统
项目实现了可扩展的图像格式支持系统：
- **LibRaw插件**: `qimage-plugins/libraw`  提供RAW格式图像支持
- **插件接口**: `main.cpp`  实现了Qt图像插件接口
- **RAW处理**: `rawiohandler.cpp`  核心RAW图像处理实现

## 3.3.2. 支持的图像格式
通过插件系统支持多种图像格式，包括但不限于：
- 常见格式：JPEG、PNG、BMP、GIF、TIFF
- RAW格式：CR2、CRW、NEF、DNG等

## 3.4. 高级功能技术

## 3.4.1. OCR文本识别
项目集成了OCR（光学字符识别）功能：
- **实时文本分析**: `livetextanalyzer.cpp`实现OCR核心功能
- **文本界面**: `LiveTextWidget.qml` 提供文本识别交互界面
- **文本块处理**: `LiveBlock.qml` 处理单个文本块的显示和交互

## 3.4.2. 打印功能
项目包含专门的打印对话框模块，提供图像打印功能。

## 3.4.3. DBus集成
通过DBus模块实现系统服务集成和进程间通信。

## 3.5. 工具链和开发支持

## 3.5.1. 多语言支持
项目支持国际化，包含翻译文件  。

## 3.5.2. 包管理
- **Debian包**: `debian/` 目录包含Debian包构建配置
- **Linglong包**: `linglong.yaml` 提供新一代Linux包管理支持

## 3.5.3. 命令行支持
通过 `commandparser.cpp` 实现命令行参数解析和处理。

## 3.6. 资源管理

## 3.6.1. 资源文件系统
- **QML资源**: `deepin-image-viewer.qrc`  包含所有QML组件
- **静态资源**: `res.qrc` 包含图标、样式等静态资源
- **素材文件**: `assets/` 目录存放应用素材

# 4. 项目特色

1. **现代化架构**: 采用Qt6/QML的现代化UI框架
2. **插件化设计**: 可扩展的图像格式支持
3. **智能功能**: 集成OCR文本识别技术
4. **系统集成**: 深度集成DTK和系统服务
5. **多架构支持**: 支持x86_64、ARM64、LoongArch等多种架构

# 5. Notes

该项目展现了现代Linux桌面应用程序的典型架构特征，结合了Qt的跨平台能力、QML的现代UI设计、C++的高性能后端处理，以及Linux系统的深度集成。通过模块化设计和插件系统，实现了良好的可扩展性和维护性。OCR功能的集成体现了应用程序向智能化方向发展的趋势。
